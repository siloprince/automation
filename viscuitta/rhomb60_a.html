
<script type="text/javascript">
var a_angle = Math.PI/3;
var ac = Math.cos(a_angle);
var as = Math.sin(a_angle);
var AC = Math.cos(a_angle/2);
var AS = Math.sin(a_angle/2);
var len = 320;
var _a = [ 1,-1, -30];
var _b = [-1, 0,  90];
var _c = [ 0,-2, 210];
var _z = [0,1];
</script>
<script type="text/javascript" src="./vis.js">{
        "id": "xxx",
        "stage": {
            "width": 1500,
            "height":1500
        },
        "iteration": {
            "dt": 1000,
            "scaleLimit": 0.01,
            "stepLimit": 5,
            "objectLimit": 40000,            
            "shapeCount": true
        },
        "polygons": [
            `<polygon class='square' opacity="0.3" fill='#aaaaaa' points='0 0, ${len/2} 0, ${len*4/5} ${len/4}, ${len*2/3} 0, ${len} 0, ${len*(1+ac)} ${len*as},${len*ac} ${len*as}' stroke='#0000ff'/>`
        ],
        "rules": [
            { 
                "pattern":[
                    ".square"
                ],
                "next":[
                    //{ "polygon":0 },
                    {
                        "polygon": 0,
                        "dx": (_z[0]*Math.cos(_a[2]*Math.PI/180)+_z[1]*Math.cos(_a[2]*Math.PI/180+a_angle))*len + (_a[1] *ac +_a[0])*len/(2*AC),
                        "dy": (_z[0]*Math.sin(_a[2]*Math.PI/180)+_z[1]*Math.sin(_a[2]*Math.PI/180+a_angle))*len + (_a[1] *as)*len/(2*AC),  
                        "dr": _a[2],
                        "ds": 1/(2*AC)       
                    },
                    {
                        "polygon": 0,
                        "dx": (_z[0]*Math.cos(_b[2]*Math.PI/180)+_z[1]*Math.cos(_b[2]*Math.PI/180+a_angle))*len + (_b[1] *ac +_b[0] )*len/(2*AC),
                        "dy": (_z[0]*Math.sin(_b[2]*Math.PI/180)+_z[1]*Math.sin(_b[2]*Math.PI/180+a_angle))*len + (_b[1] *as)*len/(2*AC),                        
                        "dr": _b[2],
                        "ds": 1/(2*AC)           
                    },
                    {
                        "polygon": 0,
                        "dx": (_z[0]*Math.cos(_c[2]*Math.PI/180)+_z[1]*Math.cos(_c[2]*Math.PI/180+a_angle))*len + (_c[1] *ac +_c[0] )*len/(2*AC),
                        "dy": (_z[0]*Math.sin(_c[2]*Math.PI/180)+_z[1]*Math.sin(_c[2]*Math.PI/180+a_angle))*len + (_c[1] *as)*len/(2*AC),                        
                        "dr": _c[2],
                        "ds": 1/(2*AC)           
                    }
                ]  
            }
        ]
    }</script>