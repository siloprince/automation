
<html>
    <script id="fs" type="x-shader/x-fragment">
uniform float time;uniform vec2 mouse, resolution;uniform vec3 spectrum;uniform sampler2D texture0, texture1, texture2, texture3, prevFrame;
#define iResolution resolution
#define iTime time
#define iMouse mouse
#define iChannel0 texture0
#define iChannel1 texture1
#define iChannel2 texture2

        const float maxiter=256.;
        const float pi = 4.0*atan(1.,1.);
        const float pi2 = pi*2.;
        const float degree = 2.0;
        const float ratio = .6;
        const float ratiopi2 = ratio*pi2;
        const float bailout = exp(ratiopi2);
        const float speed = -0.5;
        const float scale = 1.4;
        

        void mainImage(out vec4 fragColor, vec2 fragCoord) {

            float iter=0.;
            vec2 z =  scale*(2.*gl_FragCoord.xy /iResolution.y-vec2(iResolution.x/iResolution.y,1.));
            vec2 uv=2.*iMouse.xy /iResolution.y-vec2(iResolution.x/iResolution.y,1.);
            if(iMouse.xy==vec2(0.))
                uv=vec2(-1.,0.);
            bool bailed=false;
            for(float i = 0.;i<maxiter;i++)
            {
                iter=i;
                z=z*mat2(z*vec2(1,-1),z.yx)+uv;
        
                if(length(z)>bailout) {
                    bailed = true;
                    break;
                }
            }
            if (bailed==false) {
                gl_FragColor = vec4(0);
                return;
            }
            
            float cx = atan(z.y,z.x);
            float cy = log(length(z));
        
            //cx += speed*iTime*pow(degree,iter);
            
            float epsilon = 0.2;
            float delta = 0.9;
            float red = mod(cy/(ratiopi2),1.)*delta+epsilon;
            float green = 0.;
            float blue  = mod(cx/(2.*pi),1.)*delta+epsilon;  
            vec2 texCoord = vec2(blue,red);
            vec4 smpColor0 = texture2D(iChannel0, texCoord);
            vec4 smpColor1 = texture2D(iChannel1, texCoord);
            //vec4 smpColor2 = texture2D(iChannel2, texCoord);

            fragColor   = smpColor1;// * smpColor1 * smpColor2;
            //fragColor = vec4(red,green,blue,1.);
        }
        void main(void){
            vec4 fragColor = vec4(0);
            mainImage(fragColor, gl_FragCoord.xy);
            gl_FragColor = fragColor;
        }
    </script>
    <script src="./fragment.js" type="text/javascript"></script>
    <canvas id="canvas" width="512" height="256"></canvas>
</html>
    