<html>

<head>
    <meta charset="UTF-8" />
</head>

<body>
    <div style="margin:10px;">
        <svg id="red" class="draw" width="200" height="100" style="border: 1px solid #ffaaaa;" />
        <svg id="blue" class="draw" width="200" height="100" style="border: 1px solid #aaaaff;" />
        <br/>
        <input id="extrude" class="ctrl" type="range" min="50" value="100" max="400" step="1" />: 引き伸ばし
        <br/>
    </div>
    <div id="svg" style="margin:5"></div>
    <script type="text/javascript" src="./svgpath.js"></script>
    <script type="text/javascript" src="draw.js"></script>
    <script type="text/javascript">
        'use strict';
        (function (console, document) {
            let base = 100;
            update();
            let inputs = document.querySelectorAll('input.ctrl');
            for (let ii=0;ii<inputs.length;ii++) {
                inputs[ii].addEventListener('change', update);
            }
            let draws = document.querySelectorAll('svg.draw');
            for (let di=0;di<draws.length;di++) {
                draws[di].addEventListener('mouseup', update);
            }
            function update() {
                let extrude = parseFloat(document.querySelector('input#extrude').value);

                let len = base + extrude;
                let move = base / Math.sqrt(2);
                let scale = extrude / Math.sqrt(2) / base;

                let pathes = [];
                let linea = document.querySelector('path#curve_red').getAttribute('d');
                let lineb = document.querySelector('path#curve_blue').getAttribute('d');
                let transformed = [];
                transformed.push(SvgPath(linea).rotate(0).translate(0, -50).toString());
                transformed.push(SvgPath(lineb).rotate(90).translate(50, 0).toString());
                transformed.push(SvgPath(linea).rotate(0).translate(0, 50).toString());
                transformed.push(SvgPath(lineb).rotate(90).translate(-50, 0).toString());
        
        
                let path = pathListMerge(transformed);
        
                pathes.push(`<path d="${path}" fill="none" stroke="#000000" stroke-width="2"/>`);
                let svgstr = `<svg width="2000" height="2000">
                        <g transform="translate(100,100)">${pathes.join('')}</g></svg>`;
                document.querySelector('div#svg').innerHTML = svgstr;
            }
        })(console, document);
    </script>
</body>
</html>